<table border="1" cellpadding="6" cellspacing="0">
  <thead>
    <tr>
      <th>ID</th>
      <th>Name</th>
      <th>Set</th>
      <th>Type</th>
      <th>Language</th>
      <th>Grade</th>
      <th>Intent</th>
      <th style="min-width: 66px;">P. Date</th>
      <th style="min-width: 45px;">P. Price</th>
      <th style="min-width: 45px;">G. Fees</th>
      <th style="min-width: 45px;">T. Cost</th>
      <th>Status</th>
      {% if not selection_mode %}
        <th style="min-width: 48px;">L. Price</th>
        <th style="min-width: 66px;">L. Date</th>
        <th style="min-width: 48px;">S. Total</th>
        <th style="min-width: 66px;">S. Date</th>
        <th style="min-width: 48px;">T. Fees</th>
        <th>Ret. $</th>
        <th>Ret. ¥</th>
        <th>Net ¥</th>
        <th>Net %</th>
      {% endif %}
      <th style="min-width: 58px;">Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for item in items %}
      <tr>
        <td>{{ item.id }}</td>
        <td>{{ item.name }}</td>
        <td>{{ item.set_name }}</td>
        <td>{{ item.category | enum }}</td>
        <td>{{ item.language | enum }}</td>
        <td class="
          centre-aligned
          {{ 'faint' if item.grade is none else '' }}
          {% if item.grading_company == grading_company_enum.PSA and item.status != status_enum.SUBMITTED %}
            grade-psa
          {% elif item.grading_company == grading_company_enum.CGC and item.status != status_enum.SUBMITTED %}
            grade-cgc
          {% elif item.grading_company == grading_company_enum.BGS and item.status != status_enum.SUBMITTED %}
            grade-bgs
          {% endif %}
        ">
          {% if item.grade is not none %}
            {{ item.grade | int if item.grade == item.grade | int else item.grade }}
          {% else %}
            ''
          {% endif %}
        </td>
        <td class="centre-aligned">{{ item.intent | enum }}</td>
        <td>{{ item.purchase_date }}</td>
        <td class="right-aligned">{{ item.purchase_price | yen }}</td>
        <td class="right-aligned {{ 'faint' if item.total_grading_fees == 0 else '' }}">
          {{ '' if item.total_grading_fees is none else item.total_grading_fees | yen }}
        </td>
        <td class="right-aligned {{ 'faint' if item.total_cost == 0 else '' }}">
          {{ '' if item.total_cost is none else item.total_cost | yen }}
        </td>
        <td class="
          centre-aligned
          {% if item.status == status_enum.CLOSED %}
            status-closed
          {% elif item.status == status_enum.LISTED %}
            status-listed
          {% elif item.status == status_enum.VAULT %}
            status-vault
          {% elif item.status == status_enum.SUBMITTED %}
            status-submitted
          {% endif %}
        ">
          {{ item.status | enum }}
        </td>
        {% if not selection_mode %}
          <td class="right-aligned {{ 'faint' if item.list_price is none else '' }}">
            {{ '' if item.list_price is none else item.list_price | dollar }}
          </td>
          <td class="{{ 'faint' if item.list_date is none else '' }}">
            {{ '' if item.list_date is none else item.list_date }}
          </td>
          <td class="right-aligned {{ 'faint' if item.sale_total is none else '' }}">
            {{ '' if item.sale_total is none else item.sale_total | dollar }}
          </td>
          <td class="{{ 'faint' if item.sale_date is none else '' }}">
            {{ '' if item.sale_date is none else item.sale_date }}
          </td>
          <td class="right-aligned {{ 'faint' if item.total_fees is none else '' }}">
            {{ '' if item.total_fees is none else item.total_fees | dollar }}
          </td>
          <td class="right-aligned {{ 'faint' if item.return_usd is none else '' }}">
            {{ '' if item.return_usd is none else item.return_usd | dollar }}
          </td>
          <td class="right-aligned {{ 'faint' if item.return_jpy is none else '' }}">
            {{ '' if item.return_jpy is none else item.return_jpy | yen }}
          </td>
          <td class="
            right-aligned
            {% if item.net_jpy is none %}
              faint
            {% elif item.net_jpy > 0 %}
              green
            {% else %}
              cyan
            {% endif %}
          ">
            {{ '' if item.net_jpy is none else item.net_jpy | yen }}
          </td>
          <td class="
            right-aligned
            {% if item.net_jpy is none %}
              faint
            {% elif item.net_jpy > 0 %}
              green
            {% else %}
              cyan
            {% endif %}
          ">
            {{ '' if item.net_percent is none else item.net_percent | percent }}
          </td>
        {% endif %}
        <td>
          {% if selection_mode %}
            <button
              type="button"
              class="select-item"
              data-item-id="{{ item.id }}"
            >
              Select
            </button>
          {% else %}
            <a href="/delete/{{ item.id }}" onclick="return confirm('Are you sure you want to delete this item?')" style="color: red; margin-right: 10px;">
              Del
            </a>
            <a href="/edit/{{ item.id }}" style="color: purple;">
              Edit
            </a>
          {% endif %}
        </td>
        <td>
          <button
            type="button"
            class="details-btn"
            data-item-id="{{ item.id }}"
          >
            Details
          </button>
        </td>
      </tr>
      <tr id="details-{{ item.id }}" style="display: none;">
        <td colspan="5">
          <strong>Audit Item:</strong> {{ item.audit_target }}<br>
          <strong>Import Fee:</strong> {{ item.import_fee | yen }}<br>
          <strong>List Type:</strong> {{ item.list_type | enum | replace('_', ' ')}}<br>
          <strong>Exchange Rate:</strong> {{ item.usd_to_jpy_rate }}<br>
          <strong>Shipping:</strong> {{ item.shipping }}<br>
          <strong>Sale Fee:</strong> {{ item.sale_fee }}<br>
          <strong>Group Discount:</strong> {{ item.group_discount }}<br>
          <strong>Object Variant:</strong> {{ item.object_variant | enum }}<br>
          <strong>Purchase Grading Company:</strong> {{ item.purchase_grading_company | grading_company_enum_format }}<br>
          <strong>Purchase Grade:</strong> {{ item.purchase_grade }}<br>
          <strong>Purchase Cert:</strong> {{ item.purchase_cert }}<br>
          <strong>Current Cert:</strong> {{ item.cert }}<br>
          <strong>Cracked From Purchase:</strong> {{ item.cracked_from_purchase }}<br>
          <strong>Number Of Submissions:</strong> {{ item.submissions | length }}<br>
          <strong>Qualifiers:</strong>
            {% for q in item.qualifiers %}
              {{ q | enum }}{% if not loop.last %}, {% endif %}
            {% endfor %}<br>
          <strong>Details:</strong> {{ item.details }}<br>
        </td>
      </tr>
    {% endfor %}
  </tbody>
</table>
